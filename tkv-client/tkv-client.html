<!DOCTYPE html>
<html>
<head>
	<title>Leaflet Quick Start Guide Example</title>
	<meta content="width=device-width, initial-scale=1.0" name="viewport">
	<link href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" rel="stylesheet">
	<link href="./leafletjs-example-quickstart.css" rel="stylesheet">
</head>

<body ng-app="MyApp" class="sliderdemoBasicUsage" ng-controller="RenderImage as vm" ng-cloak="">
	<div id="mapid"></div>
	<script src="node_modules/angular.js"></script>
	<script src="node_modules/angular-animate.min.js"</script>
		<script src="node_modules/angular-route.min.js"></script>
		<script src="node_modules/angular-aria.min.js"></script>
		<script src="node_modules/angular-messages.min.js"></script>

		<script src="node_modules/angular-material/angular-material.js"></script>
	<script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>
	<script type="text/javascript">

		var mymap = L.map('mapid').setView([47, 4], 5);

		L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpandmbXliNDBjZWd2M2x6bDk3c2ZtOTkifQ._QA7i5Mpkd_m30IGElHziw', {
			maxZoom: 18,
			attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
			'<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
			'Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
			id: 'mapbox.streets'
		}).addTo(mymap);

		var popup = L.popup();

		function onMapClick(e) {
			popup
			.setLatLng(e.latlng)
			.setContent("You clicked the map at " + e.latlng.toString())
			.openOn(mymap);
		}


		mymap.on('click', onMapClick);

		angular.module('MyApp',['ngMaterial', 'ngMessages'])

	.controller('RenderImage', ['$scope', '$timeout', '$http', function ($scope, $timeout, $http) {
	
		var vm = this;

		vm.area = {
			lat: 47.0,
			lng: 4.0,
			zoomPow10: 0
		}
		vm.GridNbPow10 = 0

		vm.getVillagesCoordinates = function($event) {
			console.info( "newImageCenter ", $event, $event.target.x, $event.target.y,  $event.target.height, $event.target.width);
			console.info( "newImageCenter ", $event, $event.target.width, $event.target.height,  vm.area.x1, vm.area.x2, vm.area.y1, vm.area.y2);
            console.info( "newImageCenter ", $event, $event.clientX, $event.clientY, $event.pageX, $event.pageY );
            console.info( "newImageCenter x ", vm.area.x1 + (($event.pageX - $event.target.x)/$event.target.width)* (vm.area.x2 - vm.area.x1) );
            console.info( "newImageCenter y ", vm.area.y1 + (($event.pageY - $event.target.y)/$event.target.height)* (vm.area.y2 - vm.area.y1) );
            vm.area.centerX = vm.area.x1 + (($event.pageX - $event.target.x)/$event.target.width)* (vm.area.x2 - vm.area.x1);
            vm.area.centerY = vm.area.y1 + (($event.pageY - $event.target.y)/$event.target.height)* (vm.area.y2 - vm.area.y1);		
		}
	

	}]);

	</script>
	</body>
	</html>